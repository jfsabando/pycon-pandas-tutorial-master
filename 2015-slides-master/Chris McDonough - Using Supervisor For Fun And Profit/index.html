<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Using Supervisor for Fun and Profit</title><meta name="generator" content="Hovercraft! 1.0 http://regebro.github.com/hovercraft"></meta><meta name="author" content="Chris McDonough"></meta><meta name="description" content="Using Supervisor for Fun and Profit"></meta><meta name="keywords" content="supervisor, process controller:"></meta><link rel="stylesheet" href="css/hovercraft.css" media="all"></link><link rel="stylesheet" href="css/impressConsole.css" media="all"></link><link rel="stylesheet" href="css/highlight.css" media="all"></link><link rel="stylesheet" href="hovercraft.css" media="screen,projection"></link></head><body class="impress-not-supported"><div id="impress" data-transition-duration="1500"><div class="step" step="0" data-x="0" data-y="0"><img src="supervisord.gif" alt="" width="" height=""></img><h1 id="using-supervisor-for-fun-and-profit">Using Supervisor For Fun And Profit</h1><p>PyCon US 2015 (Montr&#xE9;al)</p><p>Presenter: Chris McDonough</p></div><div class="step" step="1" data-x="1600" data-y="0"><h1 id="who-am-i">Who Am I</h1><p>Python OSS developer.  Original author of <tt>Supervisor</tt>, <tt>Pyramid</tt> web
framework, and author/maintainer of a bunch of other stuff.  From
Fredericksburg VA.  Agendaless Consulting.</p><img src="pyramid-aliens1-320X200.jpg" alt="" width="" height=""></img><img src="agendaless.png" alt="" width="" height=""></img></div><div class="step" step="2" data-x="3200" data-y="0"><h1 id="who-i-am-not">Who I Am Not</h1><p>Primary maintainer of Supervisor is Mike Naberezny.  I have contributed very
little recently.</p></div><div class="step" step="3" data-x="4800" data-y="0"><h1 id="what-is-supervisor">What Is Supervisor</h1><img src="octopus.png" alt="" width="" height=""></img><h2 id="supervisor-is-a-popular-python-application-that-lets-you-control-and-monitor-process-state-on-unix-like-systems-linux-os-x-bsd">Supervisor is a popular Python application that lets you control and monitor process state on UNIX-like systems (Linux, OS X, BSD).</h2></div><div class="step" step="4" data-x="6400" data-y="0"><h1 id="what-it-does">What It Does</h1><p>It's a program that runs programs.</p><p>Programs that it runs are not required to be Python programs.</p></div><div class="step" step="5" data-x="8000" data-y="0"><p>Configuration-file-driven.  A configuration file might represent the set of
programs that must be run, in, for example a development environment for a
project.</p><p>Kinda like <tt>systemd</tt> or <tt>upstart</tt> except it's meant to be per-project
instead of "pid 1".</p></div><div class="step" step="6" data-x="9600" data-y="0"><h1 id="allows-you-to-control-processes">Allows you to control processes</h1><ul><li>Via a web interface</li><li>Via a command-line tool</li><li>Programmatically via XML-RPC</li></ul></div><div class="step" step="7" data-x="11200" data-y="0"><h1 id="web-interface">Web interface</h1><img src="webinterface.png" alt="" width="" height=""></img></div><div class="step" step="8" data-x="12800" data-y="0"><h1 id="basic-supervisorctl-commands">Basic supervisorctl commands</h1><p><tt>stop</tt>, <tt>start</tt>, <tt>restart</tt>, <tt>reload</tt>, <tt>status</tt>, <tt>tail</tt>,
<tt>maintail</tt>, <tt>shutdown</tt></p></div><div class="step" step="9" data-x="14400" data-y="0"><h1 id="more-advanced-supervisorctl-commands">More advanced supervisorctl commands</h1><p><tt>avail</tt>, <tt>update</tt>, <tt>add</tt>, <tt>reread</tt>, <tt>fg</tt></p></div><div class="step" step="10" data-x="16000" data-y="0"><h1 id="more-advanced-supervisord-conf-settings">More advanced <tt>supervisord.conf</tt> settings</h1><p><tt>numprocs</tt>, <tt>startsecs</tt>, <tt>stopsignal</tt></p></div><div class="step" step="11" data-x="17600" data-y="0"><h1 id="rpc-api">RPC API</h1><p>Everything that can be done via supervisorctl can be done via the XML-RPC API.</p></div><div class="step" step="12" data-x="19200" data-y="0"><p>Restarts programs when they crash.</p></div><div class="step" step="13" data-x="20800" data-y="0"><h1 id="understanding-process-states-and-automatic-restart-of-crashed-processes">Understanding process states, and automatic restart of crashed processes.</h1><img src="subprocess-transitions.png" alt="" width="" height=""></img></div><div class="step" step="14" data-x="22400" data-y="0"><h1 id="faq-programs-run-under-supervisor-must-not-daemonize-themselves">FAQ: Programs run under supervisor must not daemonize themselves</h1><p>In contrast to <tt>god</tt> or <tt>monit</tt>.  Supervisor does the daemonization.</p></div><div class="step" step="15" data-x="24000" data-y="0"><h1 id="event-listeners">Event Listeners</h1><p>Event listeners are programs that take tokens from supervisor on <tt>stdin</tt> and
respond on <tt>stdout</tt>.</p></div><div class="step" step="16" data-x="25600" data-y="0"><p>Started under supervisor like any other program, except they use the
<tt>[event-listener]</tt> section header instead of the <tt>[program]</tt> header.</p></div><div class="step" step="17" data-x="27200" data-y="0"><p>When they receive an event from supervisor, they can send email, send an SMS,
or use the RPC API to check for further status.</p><p><tt>httpok</tt>, <tt>crashmail</tt>, <tt>memmon</tt></p></div><div class="step" step="18" data-x="28800" data-y="0"><h1 id="supervisor-in-real-world-app-deployments">Supervisor In Real-World App Deployments</h1><p>Supervisor config snippets often go into system-level <tt>/etc/supervisord.d</tt></p><p>Ansible/SaltStack/Puppet/whatever often used to lay down supervisord snippets.</p><p>Sometimes used in the Docker community to start multiple programs inside a
container.</p></div><div class="step" step="19" data-x="30400" data-y="0"><h1 id="history">History</h1><p>Since 2004 or so, has had 3 major releases, and many minor ones.</p><p>Latest stable is in the 3-series.</p></div><div class="step" step="20" data-x="32000" data-y="0"><h1 id="future">Future</h1><p>Sometime this year, Supervisor 4.0 will be released: Py3 &amp; <tt>signal</tt> command.</p><p>Master works on Py3 now and has a <tt>signal</tt> command.</p><p>Replaced by <tt>systemd</tt> or something else?  That'd be nice.</p></div><div class="step" step="21" data-x="33600" data-y="0"><h1 id="questions">Questions</h1></div></div><div id="hovercraft-help"><table><tr><th>Space</th><td>Forward</td></tr><tr><th>Left, Down, Page Down</th><td>Next slide</td></tr><tr><th>Right, Up, Page Up</th><td>Previous slide</td></tr><tr><th>P</th><td>Open presenter console</td></tr><tr><th>H</th><td>Toggle this help</td></tr></table></div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/impressConsole.js"></script><script type="text/javascript" src="js/hovercraft.js"></script></body></html>